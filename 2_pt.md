## Статистический арбитраж с парной торговлей и Тестирование на истории (#1)

Статистический арбитраж (Stat Arb) — это торговые стратегии, которые обычно используют
преимущества либо возврата к среднему в ценах акций, либо возможностей, создаваемых аномалиями
микроструктуры рынка. Это очень количественный аналитический подход, включающий хорошо
диверсифицированный портфель ценных бумаг. Однако, чтобы проиллюстрировать концепцию, я
возьму пример парной торговли, включающей только две коинтегрированные ценные бумаги.

Торговля парами — это рыночно-нейтральная стратегия, в которой мы используем статистические
методы для определения двух акций, исторически сильно коррелирующих друг с другом. Когда происходит
отклонение в соотношении цен этих акций, мы ожидаем, что это будет возврат к среднему, и мы покупаем
акции с низкими доходами и одновременно продаем акции с лучшими результатами. Если наше
предположение о возврате к среднему верно, то цены должны приблизиться к долгосрочному среднему
значению, и торговля должна выиграть. Однако, если расхождение цен не временное, а вызвано
структурными причинами, то существует высокий риск потери денег. Вы можете найти записную книжку
Python и данные, использованные в этой статье, на моем Github . Общий подход, используемый в этой
статье, упоминается ниже:

1. Вселенная акций и идентификация коинтегрированных пар акций.
2. Выполните стационарный тест для выбранной пары.
3. Сгенерируйте торговые сигналы, используя z-score.
4. Расчет прибыли и убытков портфеля.

Вселенная акций и идентификация коинтегрированных пар акций
Наш первый шаг — определить вселенную акций и определить пары с высокой
корреляцией. Очень важно, чтобы это было основано на экономических отношениях,
таких как компании со схожим бизнесом, иначе это может быть ложным. Я взял все
составляющие NSE-100, которые относятся к категории компаний «ФИНАНСОВЫЕ УСЛУГИ».
Это дает нам список из 25 компаний для начала. Однако мы отфильтровываем компании с
ежедневными ценовыми данными менее чем за 10 лет и оставляем только последние 15 акций.
Мы берем дневную цену закрытия для этих 15 акций и разбиваем фрейм данных на тестовую и
обучающую выборки. Это сделано для того, чтобы наше решение о выборе коинтегрированной пары
основывалось на наборе обучающих данных, а тестирование на исторических данных выполнялось с
использованием набора тестовых данных вне выборки. В качестве первого шага мы воспользуемся
коэффициентом корреляции Пирсона, чтобы получить общее представление о взаимосвязи между этими
акциями, а затем поработаем над определением коинтегрированных акций с помощью функции coint
statsmodels.tsa.stattools coint, которая вернет p-значения коинтеграции. тест для каждой пары. Мы будем
хранить эти p-значения в массиве и визуализировать его как тепловую карту. Если p-значение ниже 0,05,
это означает, что мы можем отклонить нулевую гипотезу, и два временных ряда разных символов могут
быть коинтегрированы.

Kомментарий к коду:
1. Делаем необходимые импорты библиотек python.
2. Далее мы читаем nifty_meta.csv и создаем список тикеров, где индустрия
«ФИНАНСОВЫЕ УСЛУГИ» и установите даты начала и окончания.
3. Читайте ежедневные данные о ценах из Price.csv и удаляйте тикеры там, где их меньше .
данных за 10 лет.
4. Разделите фрейм данных ценообразования, чтобы иметь только ежедневные данные закрытия, и разделите их
по 50% на обучающие и тестовые наборы данных.
5. Постройте корреляцию Пирсона для ежедневной доходности, чтобы получить основное представление о
отношение.
6. Определите функцию find_cointegrated_pairs для поиска коинтегрированных пар и
соответствующие p-значения.
7. Постройте тепловую карту p-значений.

Коэффициент корреляции Пирсона варьируется от +1 до -1 и является линейной мерой
связь между двумя переменными. Значение +1 указывает на сильную положительную
корреляцию, ноль указывает на отсутствие связи, а -1 указывает на сильную
отрицательную связь. На приведенной выше тепловой карте видно, что есть несколько пар с
сильной положительной корреляцией.

Давайте также проанализируем результат коинтеграционного теста. На приведенной выше
тепловой карте видно, что существует много пар со значением p менее 0,05. Это означает, что для
этих пар мы можем отвергнуть нулевую гипотезу и их можно коинтегрировать.

## Выполнение стационарного теста для выбранной пары (#2)

Теперь у нас есть много кандидатов в пары для стратегии, где p-значение меньше 0,05. Выбор
правильной пары имеет первостепенное значение, так как стратегия не будет работать, если цены
движутся точно вместе. Чтобы наша стратегия была прибыльной, они должны быть расходящимися и
означать возврат.

Давайте возьмем тикеры BANKBARODA и SBIN и дополнительно проверим стационарность спреда
с помощью расширенного теста Дики-Фуллера. Важно, чтобы спред был стационарным. Временной
ряд считается стационарным, если такие параметры, как среднее значение и дисперсия, не
меняются с течением времени и отсутствует единичный корень. Сначала мы рассчитаем коэффициент
хеджирования между этими двумя тикерами, используя регрессию МНК. Затем, используя коэффициент
хеджирования, мы рассчитаем спред и запустим расширенный тест Дики-Фуллера.

Комментарий к коду:
1. Выберите актив1 как BANKBARODA и актив2 как SBIN.
2. Создайте фрейм данных цен закрытия двух вышеуказанных акций, используя обучающий набор
данных, и визуализируйте его.
3. Запустите регрессию МНК и получите коэффициент наклона, который также является нашим коэффициентом хеджирования.
4. Рассчитайте разброс и начертите его для визуализации.
5. Запустите расширенный тест Дики-Фуллера, чтобы проверить стационарность спреда и
наличие единичного корня.

Из приведенного выше графика видно, что цены закрытия между этими двумя акциями движутся довольно
близко друг к другу.

Высокое значение R-квадрата и близкое к нулю p-значение из регрессии OLS предполагают очень высокую
корреляцию между этими двумя акциями. Разброс выглядит стационарным, а критическое значение
расширенного теста Дики-Фуллера составляет -3,459, что меньше значения при уровне значимости 1%
(-3,435). Следовательно, мы можем отвергнуть нулевую гипотезу о том, что распространение имеет
единичный корень, и можем заключить, что оно является стационарным в
природа.